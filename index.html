<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ã¾ãªã³ãƒ¼ï½œé”äººã®æŠ•ç¨¿ï¼ˆé–²è¦§ï¼‰</title>

  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-JETCC9WWMR"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'G-LJZBTQNKKG');
  </script>

  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <!-- âœ… Supabase JSï¼ˆæ©Ÿèƒ½è¿½åŠ ãƒ»UIå¤‰æ›´ãªã—ï¼‰ -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>

<style>
    :root{
      --primary: #3b82f6;
      --primary-soft: #eff6ff;
      --bg: #f8fafc;
      --card-border: #e2e8f0;
      --text: #1e293b;
      --muted: #64748b;
    }

    body {
      background-color: var(--bg);
      color: var(--text);
      font-family: -apple-system, BlinkMacSystemFont, "Hiragino Kaku Gothic ProN", "Hiragino Sans", "Segoe UI", Roboto, "Helvetica Neue", Arial, "Meiryo", sans-serif;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      letter-spacing: -0.02em;
    }

    .font-heavy { font-weight: 800; letter-spacing: -0.01em; }

    .card-shadow{
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.05);
    }

    .surface{
      background: #fff;
      border: 1px solid var(--card-border);
    }

    .label-text {
      font-size: 0.7rem;
      font-weight: 700;
      letter-spacing: 0.05em;
      color: #94a3b8;
    }

    .bg-primary{ background: var(--primary); }
    .text-primary{ color: var(--primary); }

    .chip{
      display:inline-flex;
      align-items:center;
      gap:6px;
      padding:4px 12px;
      border-radius:999px;
      font-size:13px;
      font-weight:600;
      border:1px solid rgba(0,0,0,0.05);
      white-space: nowrap; /* ãƒãƒƒãƒ—å†…æ”¹è¡Œã‚’é˜²ã */
    }
    .chip-blue   { background: var(--primary-soft); color: var(--primary); border-color: #bfdbfe; }
    .chip-orange { background:#fff7ed; color:#c2410c; border-color:#fed7aa; }
    .chip-green  { background:#f0fdf4; color:#15803d; border-color:#bbf7d0; }
    .chip-slate  { background:#f8fafc; color:#475569; border-color:#e2e8f0; }

    /* ãƒªãƒ³ã‚¯CTAï¼šçµ±ä¸€ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆï¼ˆã‚¤ãƒ™ãƒ³ãƒˆãƒªãƒ³ã‚¯/ã‚«ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ã§åŒã˜è¦‹ãŸç›®ï¼‰ */
    .cta-link{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:8px 12px;
      border-radius:999px;
      font-size:12px;
      font-weight:800;
      background: #f8fafc;
      border: 1px solid #e2e8f0;
      color: #0f172a;
      white-space: nowrap;    /* ã€Œãƒªâ†µãƒ³ã‚¯ã€å¯¾ç­– */
      flex: 0 0 auto;         /* æŠ¼ã—ã¤ã¶ã•ã‚Œã¦æ”¹è¡Œã•ã‚Œã‚‹ã®ã‚’é˜²ã */
      min-width: 92px;        /* ãƒœã‚¿ãƒ³å¹…ã®æœ€å°ã‚’ç¢ºä¿ */
      justify-content: center;
    }
    .cta-link:hover{
      background: var(--primary-soft);
      border-color: #bfdbfe;
    }

    /* å½¹ã«ç«‹ã£ãŸï¼šã‚µãƒ–ã‚¢ã‚¯ã‚·ãƒ§ãƒ³åŒ–ï¼ˆå°ã•ããƒ»æ§ãˆã‚ã«ï¼‰ */
    .helpful-btn{
      display:inline-flex;
      align-items:center;
      gap:8px;
      padding:6px 10px;
      border-radius:999px;
      border: 1px solid #e2e8f0;
      background: #fff;
      transition: 0.2s;
      white-space: nowrap;
      flex: 0 0 auto;
    }
    .helpful-btn:hover{
      background: #f8fafc;
      border-color: #cbd5e1;
    }

    summary { list-style:none; outline: none; }
    summary::-webkit-details-marker { display:none; }
  </style>
</head>

<body class="pb-12">

  <!-- ãƒˆãƒƒãƒ—ãƒãƒ¼ -->
  <header class="sticky top-0 z-40 bg-white/90 backdrop-blur border-b border-gray-100">
    <div class="max-w-md mx-auto px-4 py-3 flex items-center justify-between">
      <button class="p-2 -ml-2 rounded-xl hover:bg-gray-100 transition" aria-label="menu">
        <i class="fa-solid fa-bars text-gray-500 text-lg"></i>
      </button>

      <div class="flex items-center gap-2">
        <div class="w-10 h-10 rounded-2xl bg-primary flex items-center justify-center">
          <i class="fa-regular fa-user text-white text-lg"></i>
        </div>
        <div class="leading-tight">
          <p class="text-[11px] font-extrabold text-gray-400 tracking-widest">APP</p>
          <p class="text-lg font-extrabold text-gray-900 -mt-0.5">ã¾ãªã³ãƒ¼</p>
        </div>
      </div>

      <div class="w-10 h-10 rounded-full overflow-hidden border border-gray-100 bg-gray-200">
        <img src="https://i.pravatar.cc/80?img=12" alt="avatar" class="w-full h-full object-cover" />
      </div>
    </div>
  </header>

  <main id="app" class="max-w-md mx-auto px-4 pt-4 relative">

    <!-- ã‚¤ãƒ™ãƒ³ãƒˆãƒ˜ãƒƒãƒ€ãƒ¼ï¼ˆMGAã‚’å°‘ã—å°ã•ãã—ã¦ä¸»å½¹ã‚’åˆ†æ•£ï¼‰ -->
    <div class="pt-2">
      <div class="surface rounded-2xl card-shadow p-5">
        <div class="flex items-center justify-between gap-3">
          <div>
            <p class="text-[11px] font-extrabold text-gray-400 tracking-widest">ã‚¤ãƒ™ãƒ³ãƒˆã‚¿ã‚¤ãƒˆãƒ«</p>
            <!-- 2xl â†’ xl ã«è¿‘ã„ã‚µã‚¤ã‚ºã¸ï¼ˆå°‘ã—ã ã‘ç¸®å°ï¼‰ -->
            <h1 class="text-xl font-extrabold text-gray-900 leading-tight">ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³</h1>
          </div>
          <div class="text-right">
            <p class="text-[12px] font-extrabold text-primary">é–²è¦§ãƒšãƒ¼ã‚¸</p>
            <p class="text-[11px] text-gray-400">ãƒ•ãƒƒã‚¯ãƒ»ã²ãã“ã¿ã‚’â€œå˜èªãƒãƒƒãƒ—â€ã§è¦šãˆã‚‹</p>
          </div>
        </div>
      </div>
    </div>

    <!-- ã‚¤ãƒ™ãƒ³ãƒˆãƒªãƒ³ã‚¯ / ã‚«ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ï¼ˆãƒªãƒ³ã‚¯CTAã‚’çµ±ä¸€ï¼‰ -->
    <div class="mt-3 space-y-3">
      <a id="event-link" href="https://www.0101.co.jp/086/news/detail.html?article_seq=11513&article_type=fea" target="_blank" rel="noopener"
         class="block surface rounded-2xl card-shadow p-5 hover:-translate-y-[1px] transition">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 rounded-2xl bg-primary-soft flex items-center justify-center">
            <i class="fa-solid fa-link text-primary"></i>
          </div>
          <div class="flex-1 min-w-0">
            <p class="text-[11px] font-extrabold text-gray-400 tracking-widest">ã‚¤ãƒ™ãƒ³ãƒˆãƒªãƒ³ã‚¯</p>

            <div class="flex items-center justify-between gap-3 mt-1">
              <p class="text-base font-extrabold text-gray-900 truncate">ä»Šå›ã®ã‚¤ãƒ™ãƒ³ãƒˆè©³ç´°</p>
              <span class="cta-link">
                <i class="fa-solid fa-arrow-up-right-from-square text-gray-500"></i>
                å…¬å¼ãƒšãƒ¼ã‚¸ã¸
              </span>
            </div>

            <p class="text-[11px] text-gray-500 mt-1">
              å…¬å¼HPã«é·ç§»ã—ã€è©³ç´°æƒ…å ±ã‚’ç¢ºèªã§ãã¾ã™ã€‚
            </p>
          </div>
        </div>
      </a>

      <a id="card-link" href="#" target="_blank" rel="noopener"
         class="block surface rounded-2xl card-shadow p-5 hover:-translate-y-[1px] transition">
        <div class="flex items-start gap-3">
          <div class="w-10 h-10 rounded-2xl bg-orange-50 flex items-center justify-center">
            <i class="fa-regular fa-credit-card text-orange-600"></i>
          </div>
          <div class="flex-1 min-w-0">
            <p class="text-[11px] font-extrabold text-gray-400 tracking-widest">ã‚«ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ï¼ˆæº–å‚™ä¸­ï¼‰</p>

            <div class="flex items-center justify-between gap-3 mt-1">
              <p class="text-base font-extrabold text-gray-900 truncate">é–¢é€£ã‚«ãƒ¼ãƒ‰</p>
              <span class="cta-link">
                <i class="fa-solid fa-arrow-up-right-from-square text-gray-500"></i>
                æº–å‚™ä¸­
              </span>
            </div>

            <p class="text-[11px] text-gray-500 mt-1">
             ä»Šå›ã®ã‚¤ãƒ™ãƒ³ãƒˆã«é–¢é€£ã—ãŸã‚«ãƒ¼ãƒ‰ã®ãƒšãƒ¼ã‚¸ã«é·ç§»ã—ã¾ã™ã€‚å…¥ä¼šç‰¹å…¸ãªã©ã‚’ç¢ºèªã§ãã¾ã™ã€‚
            </p>
          </div>
        </div>
      </a>
    </div>

    <!-- æŠ•ç¨¿ã‚»ã‚¯ã‚·ãƒ§ãƒ³è¦‹å‡ºã— -->
    <div class="mt-4 surface rounded-2xl card-shadow p-5">
      <div class="flex items-center justify-between gap-3">
        <div>
          <p class="text-[11px] font-extrabold text-gray-400 tracking-widest">æŠ•ç¨¿</p>
          <h2 class="text-xl font-extrabold text-gray-900 leading-tight">é”äººã®æŠ•ç¨¿</h2>
        </div>
        <a id="hook-help-link" href="#" class="inline-flex items-center gap-2 px-3 py-2 rounded-2xl border border-gray-200 bg-gray-50 text-sm font-extrabold text-gray-700 hover:bg-gray-100 transition whitespace-nowrap">
          <i class="fa-regular fa-circle-question text-gray-500"></i>
          ãƒ•ãƒƒã‚¯ãƒ»å¼•ãè¾¼ã¿ã¨ã¯ï¼Ÿ
        </a>
      </div>
      <p class="text-[11px] text-gray-400 mt-2">ãƒ•ãƒƒã‚¯ãƒ»ã²ãã“ã¿ã‚’â€œå˜èªãƒãƒƒãƒ—â€ã§è¦šãˆã‚‹</p>
    </div>

    <!-- ä¸€è¦§ -->
    <div id="ranking-container" class="space-y-4 pb-20 mt-4"></div>

    <!-- âœ… è¿½åŠ ï¼šæŠ•ç¨¿ / ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆï¼ˆæ¨ªä¸¦ã³ï¼‰â€»æœ¬å½“ã«ä¸€ç•ªä¸‹ -->
    <div class="mt-4">
      <div class="grid grid-cols-2 gap-3">
        <a id="post-btn" href="#"
           class="surface rounded-2xl card-shadow p-4 hover:-translate-y-[1px] transition flex items-center justify-center gap-2 font-extrabold text-gray-900">
          <i class="fa-solid fa-pen-to-square text-gray-500"></i>
          æŠ•ç¨¿
        </a>

        <a id="survey-btn" href="#"
           class="surface rounded-2xl card-shadow p-4 hover:-translate-y-[1px] transition flex items-center justify-center gap-2 font-extrabold text-gray-900">
          <i class="fa-solid fa-clipboard-list text-gray-500"></i>
          ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆ
        </a>
      </div>

      <div class="mt-2 space-y-1 pb-2">
        <p class="text-[11px] text-gray-500">â€»é‹å–¶ä¸­ã«ãŠæ°—ã¥ãã®ç‚¹ãŒã‚ã‚Œã°ã€ã€ŒæŠ•ç¨¿ã€ã‹ã‚‰ãœã²å…±æœ‰ã—ã¦ãã ã•ã„ï¼ˆã„ã¤ã§ã‚‚OKï¼‰</p>
        <p class="text-[11px] text-gray-500">â€»ã”åˆ©ç”¨å¾Œã«ã€Œã‚¢ãƒ³ã‚±ãƒ¼ãƒˆã€ã¸ã®ã”å›ç­”ã«ã”å”åŠ›ã‚’ãŠé¡˜ã„ã„ãŸã—ã¾ã™</p>
      </div>
    </div>

  </main>

  <script>
    let posts = [
      {
        id: 1,
        staff_name: "æ«»äº•ã•ã‚“",
        event_name: "ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³",
        store_name: "æœ‰æ¥½ç”º",
        
        // ğŸ· å±æ€§ï¼šå®¢å±¤ï¼†çŠ¶æ³
        tags: [
          "20ã€œ60ä»£å¥³æ€§",
          "æ€¥ã„ã§ã‚‹äººå¤šã„",
          "æ‰‹çŸ­ã«",
        ],
        // ğŸª ãƒ•ãƒƒã‚¯ï¼šçŸ­ã„â€œè¨€ã„å›ã—â€ã‚’ãƒãƒƒãƒ—åŒ–
        hook_words: [
          "ãƒã‚¤ãƒ³ãƒˆã§å‰²å¼•ã§ãã¾ã™ãŒã€ã‚¨ãƒã‚¹ã‚«ãƒ¼ãƒ‰ãŠæŒã¡ã§ã™ã‹ï¼Ÿ",
        ],

        // ğŸ“¢ å¼•ãè¾¼ã¿ï¼šé­…åŠ›ã®æ ¸ï¼ˆ=å¼•ãè¾¼ã¿ï¼‰ã‚’ãƒãƒƒãƒ—åŒ–
        pitch_words: [
          "ãŠä¼šè¨ˆã‹ã‚‰ã™ã3000å††å‰²å¼•",
          "ãƒãƒ§ã‚³ä¾¡æ ¼ä¸Šæ˜‡ãªã®ã§ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã§å‰²å¼•ä¸­",
        ],

        // ğŸ§¾ ã‚«ãƒ¼ãƒ‰èª¬æ˜ï¼šãƒãƒƒãƒ—
        card_words: [
          "æ˜”ã®ãƒãƒ«ã‚¤ã‚«ãƒ¼ãƒ‰ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ãŒå¼·ã„äººå¤šã„",
          "ã„ã¾ã®ã‚¨ãƒã‚¹ã‚’ã—ã£ã‹ã‚Šèª¬æ˜",
          "æ‰€è¦20åˆ†å‰å¾Œ",
          "æ™‚é–“ãªã„äººã«ã¯ç„¡ç†ã«å‹§ã‚ãªã„",
        ],

        // â–¼ å…¨æ–‡ï¼ˆdetailsã§è¦‹ã‚‹ç”¨ï¼‰â€» ã“ã“ã‚’åˆ†å‰²ï¼
        hook_content:
`ã€ãƒ•ãƒƒã‚¯ï¼ˆãƒ¬ã‚¸ã‚’æ‰“ã¡ãªãŒã‚‰ï¼‰ã€‘
ã€Œã“ã¡ã‚‰ã®å£²ã‚Šå ´ã§ã‚‚ã‚¨ãƒã‚¹ã®ãƒã‚¤ãƒ³ãƒˆã§å‰²å¼•ãå‡ºæ¥ã‚‹ã®ã§ãŠå¾…ã¡ã§ã™ã‹ï¼Ÿã€

ãƒ»æœ‰æ¥½ç”ºã§ã‚‚åŠåˆ†ãã‚‰ã„ã®ãŠå®¢æ§˜ã¯ã‚¨ãƒã‚¹ã‚«ãƒ¼ãƒ‰ãŠæŒã¡ã®æ–¹ãŒå¤šã‹ã£ãŸã®ã§ã“ã®èãæ–¹ã®æ–¹ãŒæŒã£ã¦ã‚‹æ–¹ã¯ã‚¨ãƒã‚¹ã§æ”¯æ‰•ã„ã—ã¦ã‚‚ã‚‰ãˆãŸã‚Šã€çµæœãƒã‚¤ãƒ³ãƒˆãŒè²¯ã¾ã£ã¦ã¦å–œã‚“ã§ã‚‚ã‚‰ãˆã‚‹ã‚±ãƒ¼ã‚¹ãŒå¤šã‹ã£ãŸã€‚
ãƒ»æŒã£ã¦ãªã„æ–¹ã¯ã“ã®èãæ–¹ã ã¨ã€ŒæŒã£ã¦ã‚‹ã‘ã©å¿˜ã‚Œã¾ã—ãŸã€ã¨ã‹ã€ŒæŒã£ã¦ã¾ã›ã‚“ã€ã¨ç¢ºèªãŒå‡ºæ¥ã‚‹ã€‚`,

        // âœ… å¼•ãè¾¼ã¿ï¼ˆå…¨æ–‡ï¼‰
        pitch_content:
`ã€å¼•ãè¾¼ã¿ã€‘
ã¾ãšã€Œéå»ã«ä½œã£ãŸäº‹ã‚ã‚Šã¾ã™ã‹ï¼Ÿã€ã¨ç¢ºèªã—ã¦ã‹ã‚‰
ã€Œä»Šã€ãƒãƒ¬ãƒ³ã‚¿ã‚¤ãƒ³ã«åˆã‚ã›ã¦ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã‚„ã£ã¦ã¦ä½œã£ãŸäº‹ãªã„æ–¹ãŒã‚¹ãƒãƒ›ã§ä½œã£ã¦ã“ã®ã‚«ãƒ¼ãƒ‰ã§æ”¯æ‰•ã„ã™ã‚‹ã¨ã“ã®ãŠä¼šè¨ˆã‹ã‚‰ã™ãã«3000å††å‰²å¼•ãã«ãªã‚Šã¾ã™ã‚ˆã€
ã¾ãŸã¯
ã€Œä»Šã€ãƒãƒ§ã‚³ãƒ¬ãƒ¼ãƒˆã‚‚ä¾¡æ ¼ãŒä¸ŠãŒã£ãŸã‚Šã€è‡ªåˆ†ç”¨ã«è²·ã†æ–¹ãŒå¤šã„ã®ã§ã‚­ãƒ£ãƒ³ãƒšãƒ¼ãƒ³ã§3000å††å‰²å¼•ãä»˜ã‘ã¦ã¾ã™ã€

ãƒ»Le TAOã¨ã‹ãƒ‡ãƒ«ãƒ¬ã‚¤ãªã©ã®å•†å“ã‚’è²·ã†æ–¹ã¯è‡ªåˆ†ç”¨ã§è²·ã†æ–¹ãŒå¤šã„ã®ã§ä½œã£ã¦ãã‚Œã‚‹ã‚±ãƒ¼ã‚¹ãŒå¤šã‹ã£ãŸã€‚`,

        // âœ… ã‚«ãƒ¼ãƒ‰èª¬æ˜ï¼ˆå…¨æ–‡ï¼‰
        card_content:
`ã€ã‚«ãƒ¼ãƒ‰èª¬æ˜ï¼ˆé£Ÿå“ã‚¤ãƒ™ãƒ³ãƒˆå‘ã‘ï¼šçŸ­ããƒ»å®‰å¿ƒã‚’æœ€å¾Œã«ï¼‰ã€‘
é£Ÿå“ã®ã‚¤ãƒ™ãƒ³ãƒˆã¯æ€¥ã„ã§ã‚‹æ–¹ã‚‚å¤šã„ã®ã§
ã€ŒãŠä½œã‚Šã™ã‚‹ãŠæ™‚é–“å¤§ä¸ˆå¤«ãªã‚‰2å¹´ç›®ä»¥é™ã‚‚å¹´ä¼šè²»ã‚„æ›´æ–°è²»ãªã©ã‚‚ãªã„VISAã®ä»˜ã„ãŸã‚¯ãƒ¬ã‚¸ãƒƒãƒˆã‚«ãƒ¼ãƒ‰ã§ãŠå®¢æ§˜ã®ã‚¹ãƒãƒ›ã‹ã‚‰å…¥ä¼šãŒå‡ºæ¥ã¦ã“ã®å ´ã§3000å††å‰²å¼•ã„ã¦âšªï¸âšªï¸âšªï¸å††ã§è²·ã£ã¦é ‚ã‘ã¾ã™ã‚ˆã€

â€»ã“ã®æ™‚ç‚¹ã§æ™‚é–“ãŒãªã„ã¨ã„ã†æ–¹ã¯ç„¡ç†ã›ãšã€Œã˜ã‚ƒã€åˆæ¬¡å›ãŠé¡˜ã„ã—ã¾ã™ã€ã¨ç„¡ç†ã«ãŠå‹§ã‚ã—ã¾ã›ã‚“ã€‚
ã©ã®ãã‚‰ã„ã‹ã‹ã‚Šã¾ã™ã‹ï¼Ÿã¨èã‹ã‚ŒãŸå ´åˆã‚‚ã€Œæ—©ã„æ–¹ã§20åˆ†å‰å¾Œã§ã™ã‹ã­ï¼Ÿã€ã¨ã™ãå‡ºæ¥ã‚‹ã¨ã¯è¨€ã‚ãšç´å¾—ã•ã‚ŒãŸæ–¹ã ã‘æ¡ˆå†…ã€‚
â€»3000å††æœªæº€ã®ãŠè²·ã„ä¸Šã’ã®æ–¹ã¯ã€Œä»Šæ—¥ã‚«ãƒ¼ãƒ‰ã§è²·ã£ã¦ã‚‚å¼•ãè½ã¨ã—ãŒãªã„ã®ã§ãã®ã¾ã¾å•†å“ãŠæŒã¡å¸°ã‚Šå‡ºæ¥ã¾ã™ã‚ˆã€ãªã©èª¬æ˜ã‚‚éŸ¿ãã¾ã™ã€‚`,

        // âœ… è£œè¶³ãƒ¡ãƒ¢ï¼ˆå…¨æ–‡ï¼‰
        memo_content:
`ã€è£œè¶³ãƒ¡ãƒ¢ã€‘
ãƒ»é£Ÿå“ã®ã‚¤ãƒ™ãƒ³ãƒˆå…¨èˆ¬çš„ã«æ€¥ã„ã§ã‚‹æ–¹ã‚„æ™‚é–“ã®ãªã„æ–¹ãŒå¤šã„ã®ã§æ™‚é–“ãŒãªã„æ–¹ã«ã¯ç„¡ç†ã«å‹§ã‚ãªã„ã€‚
ï¼ˆç„¡ç†ã«å‹§ã‚ã¦ã‚‚é€”ä¸­é›¢è„±ãŒå¤šã„ã—ã€ã¡ã‚ƒã‚“ã¨èª¬æ˜ã—ã¦ã‚‚å¹´ä»£ä¸Šã®æ–¹ã¯é¢å€’ãã•ã„ã¨æˆ»ã£ã¦ãã‚‹ã‹ã‚‰ï¼‰
ãƒ»å¹´ä»£ä¸Šã®æ–¹ãŒå¤šã„ã®ã§æ˜”ã®ãƒãƒ«ã‚¤ã®ã‚«ãƒ¼ãƒ‰ã®ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’æŒã£ã¦ã„ã‚‹æ–¹ãŒå¤šã„ã®ã§ã€2å¹´ç›®ä»¥é™ã‚‚ä¼šè²»ãŒã‹ã‹ã‚‰ãªã„ãƒ»ãŠç”³è¾¼ã¿ã«ç´™ã¯ä½¿ã‚ãšãŠå®¢æ§˜ã®ã‚¹ãƒãƒ›ã ã‘ã§å‡ºæ¥ã‚‹ãƒ»VISAãŒä»˜ã„ã¦ã‚‹ã®ã§ãƒãƒ«ã‚¤ä»¥å¤–ã§ã‚‚ä½¿ãˆã‚‹ãªã©ã—ã£ã‹ã‚ŠãŠè©±ã—ã™ã‚‹äº‹ãŒå¤§åˆ‡ã€‚
ãƒ»é•·ã„å£ã‚³ãƒŸã¯ç²¾ç®—åˆ—ãŒé•·ããªã‚‹ã®ã§æ‰‹çŸ­ã«ãŠå‹§ã‚ã¯ç²˜ã‚‰ãªã„ã€‚
ã“ã®è¾ºãŒãƒã‚¤ãƒ³ãƒˆã ã¨æ€ã„ã¾ã™ã€‚`,

        likes: 18,
        helpful: 0
      }
    ];

    function chipsHtml(words, colorClass) {
      if (!Array.isArray(words) || words.length === 0) return '';
      return words.map(w => `<span class="chip ${colorClass}">${escapeHtml(w)}</span>`).join('');
    }

    function renderRanking() {
      const container = document.getElementById('ranking-container');
      if (!container) return;
      container.innerHTML = '';

      const sorted = [...posts].sort((a, b) => (b.likes || 0) - (a.likes || 0));

      sorted.forEach((p, idx) => {
        const medal = idx === 0 ? 'ğŸ¥‡' : idx === 1 ? 'ğŸ¥ˆ' : idx === 2 ? 'ğŸ¥‰' : 'ğŸ“„';

        const card = document.createElement('div');
        card.className = "surface p-5 rounded-2xl card-shadow";

        card.innerHTML = `
          <div class="flex justify-between items-start mb-4 gap-3">
            <div class="min-w-0">
              <span class="text-[10px] bg-[var(--primary-soft)] text-primary px-2 py-0.5 rounded-full font-extrabold border border-[#bfdbfe]">
                ${escapeHtml(p.event_name)}
              </span>
              <h3 class="font-extrabold text-gray-900 mt-1 truncate">${medal} ${escapeHtml(p.staff_name)}
                <span class="text-xs text-gray-400 font-normal">@${escapeHtml(p.store_name || "-")}</span>
              </h3>
            </div>

            <!-- å½¹ã«ç«‹ã£ãŸï¼šã‚µãƒ–åŒ–ï¼ˆå°ã•ã‚ãƒ»æ§ãˆã‚ï¼‰ -->
            <button onclick="helpfulPost(${p.id})" class="helpful-btn" aria-label="å½¹ã«ç«‹ã£ãŸ">
              <i class="fa-regular fa-thumbs-up text-gray-500 text-[14px]"></i>
              <span class="text-[12px] font-extrabold text-gray-800">å½¹ã«ç«‹ã£ãŸ</span>
              <span class="text-[11px] font-extrabold text-gray-500">(${p.helpful || 0})</span>
            </button>
          </div>

          <div class="mb-3">
            <p class="text-[10px] font-extrabold text-orange-600 mb-2">ğŸª ãƒ•ãƒƒã‚¯</p>
            <div class="flex flex-wrap gap-2">
              ${chipsHtml(p.hook_words, 'chip-orange')}
            </div>
          </div>

          <div class="mb-3">
            <p class="text-[10px] font-extrabold text-green-700 mb-2">ğŸ“¢ å¼•ãè¾¼ã¿</p>
            <div class="flex flex-wrap gap-2">
              ${chipsHtml(p.pitch_words, 'chip-green')}
            </div>
          </div>

          <div class="mb-3">
            <p class="text-[10px] font-extrabold text-primary mb-2">ğŸ§¾ ã‚«ãƒ¼ãƒ‰èª¬æ˜</p>
            <div class="flex flex-wrap gap-2">
              ${chipsHtml(p.card_words, 'chip-blue')}
            </div>
          </div>

          <div class="mb-1">
            <p class="text-[10px] font-extrabold text-slate-700 mb-2">ğŸ· å±æ€§</p>
            <div class="flex flex-wrap gap-2">
              ${chipsHtml(p.tags, 'chip-slate')}
            </div>
          </div>

          <details class="mt-4 details-anim rounded-2xl border border-gray-200 bg-gray-50">
            <summary class="px-4 py-3 cursor-pointer flex items-center justify-between">
              <span class="text-sm font-extrabold text-gray-800">å…¨æ–‡ã‚’è¦‹ã‚‹</span>
              <i class="fa-solid fa-chevron-down text-gray-400 chev"></i>
            </summary>
            <div class="px-4 pb-4">

              <div class="mt-3 p-4 bg-orange-50 rounded-2xl">
                <p class="text-[11px] font-extrabold text-orange-600 mb-2">ğŸª ãƒ•ãƒƒã‚¯ï¼ˆå…¨æ–‡ï¼‰</p>
                <p class="text-sm text-gray-700 whitespace-pre-wrap">${escapeHtml(p.hook_content || "")}</p>
              </div>

              <div class="mt-3 p-4 bg-green-50 rounded-2xl">
                <p class="text-[11px] font-extrabold text-green-700 mb-2">ğŸ“¢ å¼•ãè¾¼ã¿ï¼ˆå…¨æ–‡ï¼‰</p>
                <p class="text-sm text-gray-700 whitespace-pre-wrap">${escapeHtml(p.pitch_content || "")}</p>
              </div>

              <div class="mt-3 p-4 bg-blue-50 rounded-2xl">
                <p class="text-[11px] font-extrabold text-primary mb-2">ğŸ§¾ ã‚«ãƒ¼ãƒ‰èª¬æ˜ï¼ˆå…¨æ–‡ï¼‰</p>
                <p class="text-sm text-gray-700 whitespace-pre-wrap">${escapeHtml(p.card_content || "")}</p>
              </div>

              <div class="mt-3 p-4 bg-slate-50 rounded-2xl">
                <p class="text-[11px] font-extrabold text-slate-700 mb-2">ğŸ“ è£œè¶³ãƒ¡ãƒ¢</p>
                <p class="text-sm text-gray-700 whitespace-pre-wrap">${escapeHtml(p.memo_content || "")}</p>
              </div>

            </div>
          </details>
        `;

        container.appendChild(card);
      });
    }

    // âœ… Supabaseï¼ˆæ©Ÿèƒ½è¿½åŠ ãƒ»UIå¤‰æ›´ãªã—ï¼‰
    const SUPABASE_URL = "https://uwlpkdgcfzdhgiptasov.supabase.co";
    const SUPABASE_PUBLISHABLE_KEY = "sb_publishable_vKVE-SAFvXjq5fLHApnqFg_B5QbxJZq";
    const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_PUBLISHABLE_KEY);

    async function ensureAnonSession() {
      const { data, error } = await supabaseClient.auth.getSession();
      if (error) throw error;
      if (data && data.session) return;

      const { error: signInError } = await supabaseClient.auth.signInAnonymously();
      if (signInError) throw signInError;
    }

    async function loadHelpfulCountsFromDB() {
      const ids = posts.map(p => p.id);
      const { data, error } = await supabaseClient
        .from("posts")
        .select("id, helpful_count")
        .in("id", ids);

      if (error) throw error;

      const map = new Map((data || []).map(row => [row.id, row.helpful_count]));
      posts.forEach(p => {
        const v = map.get(p.id);
        if (typeof v === "number") p.helpful = v;
      });
    }

    window.helpfulPost = async function(id) {
      try {
        await ensureAnonSession();

        const { data, error } = await supabaseClient
          .rpc("vote_helpful", { p_post_id: id });

        if (error) throw error;

        const post = posts.find(p => p.id === id);
        if (post) {
          post.helpful = typeof data === "number" ? data : (post.helpful || 0);
          renderRanking();
        }
      } catch (e) {
        console.error(e);
        // UIã¯å¤‰ãˆãªã„æ¡ä»¶ãªã®ã§ã€ç”»é¢è¡¨ç¤ºã¯å¤‰ãˆãšã«consoleã ã‘
      }
    };

    function escapeHtml(str) {
      return String(str)
        .replaceAll("&", "&amp;")
        .replaceAll("<", "&lt;")
        .replaceAll(">", "&gt;")
        .replaceAll('"', "&quot;")
        .replaceAll("'", "&#039;");
    }

    // ===============================
    // âœ… è¿½åŠ ï¼šæŠ•ç¨¿ / ã‚¢ãƒ³ã‚±ãƒ¼ãƒˆï¼ˆå‹•ä½œã ã‘ä»˜ä¸ãƒ»UIã¯ä¸Šã§è¿½åŠ æ¸ˆã¿ï¼‰
    // ===============================
    const POST_URL = "https://docs.google.com/forms/d/1ZVv_aefg2sSfXiKEzNXprRJEb0C0tQiUAH50M_l-RAs/edit?usp=forms_home&ouid=117951192700997366273&ths=true";
    const SURVEY_URL = "https://docs.google.com/forms/d/1P8QJ34C5Mt6PQq82GSrHhbm3K8mQK-gSNp33HA9at9k/edit";

    window.addEventListener('load', () => {
      const postBtn = document.getElementById('post-btn');
      const surveyBtn = document.getElementById('survey-btn');

      if (postBtn) {
        postBtn.href = POST_URL;
        postBtn.target = "_blank";
        postBtn.rel = "noopener";
      }

      if (surveyBtn) {
        surveyBtn.href = SURVEY_URL;
        surveyBtn.target = "_blank";
        surveyBtn.rel = "noopener";
      }
    });

    // ===============================
    // ã€Œãƒ•ãƒƒã‚¯ãƒ»å¼•ãè¾¼ã¿ã¨ã¯ï¼Ÿã€åˆ¥ã‚¿ãƒ–ï¼ˆ1HTMLå®Œçµï¼‰
    // ===============================
    const HOOK_HELP_HTML = `<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ãƒ•ãƒƒã‚¯ãƒ»å¼•ãè¾¼ã¿ã¨ã¯ï¼Ÿï½œã‚«ãƒ¼ãƒ‰ã”æ¡ˆå†…ã®æµã‚Œ</title>

  <script src="https://cdn.tailwindcss.com"><\/script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

  <style>
    body { background-color: #f8f9ff; color: #333; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; }
    .card-shadow { box-shadow: 0 4px 20px rgba(0,0,0,0.05); }
    .accent-purple { background-color: #f3f0ff; border: 1px solid #e9e4ff; }
    @keyframes popIn { 0% { transform: scale(0.98); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
    .pop { animation: popIn 0.25s ease-out; }
        .back-btn{
      position: fixed;
      left: 16px;
      bottom: 16px;
      z-index: 9999;
      display: inline-flex;
      align-items: center;
      gap: 10px;
      padding: 12px 14px;
      border-radius: 999px;
      border: 1px solid #e5e7eb;
      background: rgba(255,255,255,0.92);
      backdrop-filter: blur(8px);
      -webkit-backdrop-filter: blur(8px);
      box-shadow: 0 10px 24px rgba(0,0,0,0.10);
      font-weight: 800;
      font-size: 14px;
      color: #111827;
      user-select: none;
      -webkit-tap-highlight-color: transparent;
    }
    .back-btn:active{
      transform: translateY(1px);
    }

  </style>
</head>

<body class="p-4 pb-12">
  <div class="max-w-md mx-auto">

    <!-- Header -->
    <div class="sticky top-0 z-30 bg-[#f8f9ff]/90 backdrop-blur-sm pt-2 pb-4">
      <div class="bg-white rounded-2xl card-shadow border border-gray-100 p-5 pop">
        <div class="flex items-start justify-between gap-3">
          <div>
            <p class="text-[11px] font-bold text-gray-400 tracking-widest">èª¬æ˜ãƒšãƒ¼ã‚¸</p>
            <h1 class="text-2xl font-extrabold text-gray-800 leading-tight">ãƒ•ãƒƒã‚¯ãƒ»å¼•ãè¾¼ã¿ã¨ã¯ï¼Ÿ</h1>
            <p class="text-sm text-gray-500 mt-1">ã‚«ãƒ¼ãƒ‰ã‚’ã”æ¡ˆå†…ã™ã‚‹ã¨ãã®â€œè©±ã™é †ç•ªâ€</p>
          </div>
          <div class="w-11 h-11 rounded-2xl bg-purple-50 border border-purple-100 flex items-center justify-center">
            <i class="fa-solid fa-route text-purple-600"></i>
          </div>
        </div>

        <div class="mt-4 p-4 rounded-2xl accent-purple">
          <p class="text-sm font-bold text-gray-800">
            <span class="text-purple-600">ã“ã®é †ç•ª</span>ã§è©±ã™ã“ã¨ãŒã€ã¨ã£ã¦ã‚‚å¤§äº‹
          </p>
          <p class="text-xs text-gray-600 mt-1">
            ã€Œèˆˆå‘³ã‚’æŒã¤ â†’ æ°—ã«ãªã‚‹ â†’ ç´å¾—ã™ã‚‹ã€ã®æµã‚Œã‚’ä½œã‚Œã¾ã™ã€‚
          </p>
        </div>
      </div>
    </div>

    <!-- Flow -->
    <div class="space-y-4">
      <div class="bg-white p-5 rounded-2xl card-shadow border border-gray-100 pop">
        <div class="flex items-center gap-2 font-bold text-gray-800">
          <i class="fa-solid fa-list-ol text-slate-500"></i>
          <h2 class="text-base">ã‚«ãƒ¼ãƒ‰ã”æ¡ˆå†…ã®ãªãŒã‚Œ</h2>
        </div>

        <div class="mt-4 space-y-3">
          <!-- Step 1 -->
          <div class="flex items-start gap-3">
            <div class="shrink-0 w-9 h-9 rounded-xl bg-orange-50 border border-orange-100 flex items-center justify-center">
              <span class="text-sm font-extrabold text-orange-500">1</span>
            </div>
            <div class="flex-1">
              <p class="font-extrabold text-gray-800 flex items-center gap-2">
                <span>ãƒ•ãƒƒã‚¯</span>
                <span class="text-[10px] bg-orange-50 text-orange-600 px-2 py-0.5 rounded-full font-bold">é–¢å¿ƒã‚’æŒã¤ãã£ã‹ã‘</span>
              </p>
              <p class="text-sm text-gray-600 mt-1">ã¾ãšã¯ã€Œè©±ã‚’èãç†ç”±ã€ã‚’ä½œã‚‹ä¸€è¨€ã€‚</p>
            </div>
          </div>

          <!-- Step 2 -->
          <div class="flex items-start gap-3">
            <div class="shrink-0 w-9 h-9 rounded-xl bg-green-50 border border-green-100 flex items-center justify-center">
              <span class="text-sm font-extrabold text-green-600">2</span>
            </div>
            <div class="flex-1">
              <p class="font-extrabold text-gray-800 flex items-center gap-2">
                <span>å¼•ãè¾¼ã¿</span>
                <span class="text-[10px] bg-green-50 text-green-700 px-2 py-0.5 rounded-full font-bold">æ°—ã«ãªã‚‹ç†ç”±ã‚’å‡ºã™</span>
              </p>
              <p class="text-sm text-gray-600 mt-1">ãŠå®¢æ§˜ã®é–¢å¿ƒã«åˆã‚ã›ãŸé­…åŠ›ã‚’ä¼ãˆã‚‹ã€‚</p>
            </div>
          </div>

          <!-- Step 3 -->
          <div class="flex items-start gap-3">
            <div class="shrink-0 w-9 h-9 rounded-xl bg-slate-50 border border-slate-200 flex items-center justify-center">
              <span class="text-sm font-extrabold text-slate-700">3</span>
            </div>
            <div class="flex-1">
              <p class="font-extrabold text-gray-800 flex items-center gap-2">
                <span>ã‚¨ãƒã‚¹ã‚«ãƒ¼ãƒ‰èª¬æ˜</span>
                <span class="text-[10px] bg-slate-100 text-slate-700 px-2 py-0.5 rounded-full font-bold">æœ€å¾Œã«åŸºæœ¬</span>
              </p>
              <p class="text-sm text-gray-600 mt-1">å®‰å¿ƒã§ãã‚‹æƒ…å ±ã‚’ä¼ãˆã¦ã€ç”³è¾¼ã«ã¤ãªã’ã‚‹ã€‚</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Example -->
      <div class="bg-white rounded-2xl card-shadow border border-gray-100 overflow-hidden pop">
        <div class="p-5 border-b border-dashed border-gray-200">
          <div class="flex items-center gap-2 font-bold text-gray-800">
            <i class="fa-solid fa-lightbulb text-yellow-500"></i>
            <h2 class="text-base">ä¾‹ãˆã°ï¼ˆMGAã®å ´åˆï¼‰</h2>
          </div>
          <p class="text-xs text-gray-500 mt-1">â€œãƒ•ãƒƒã‚¯ â†’ å¼•ãè¾¼ã¿ â†’ èª¬æ˜â€ã®é †ã«è©±ã™ä¾‹</p>
        </div>

        <div class="p-5 space-y-3">
          <div class="p-4 bg-orange-50 rounded-2xl">
            <p class="text-[11px] font-bold text-orange-600 mb-2">ğŸª ãƒ•ãƒƒã‚¯</p>
            <p class="text-sm text-gray-800 font-bold">ã€ŒMGAã®ãƒ•ã‚¡ãƒ³ã‚¯ãƒ©ãƒ–å…¥ã£ã¦ã„ã¾ã™ï¼Ÿã€</p>
            <p class="text-xs text-gray-600 mt-2">ï¼ˆé–¢å¿ƒã‚’ã‚‚ã¤ãã£ã‹ã‘ï¼‰</p>
          </div>

          <div class="p-4 bg-green-50 rounded-2xl">
            <p class="text-[11px] font-bold text-green-700 mb-2">ğŸ“¢ å¼•ãè¾¼ã¿</p>
            <p class="text-sm text-gray-800 font-bold">ã€ŒMGAã®ã‚¨ãƒã‚¹ã‚«ãƒ¼ãƒ‰ãŒã‚ã‚‹ã‚“ã§ã™ãŒã€æœ¬æ—¥å…¥ä¼šã„ãŸã ãã¨ã€ãƒ•ã‚¡ãƒ³ã‚¯ãƒ©ãƒ–å¹´ä¼šè²»ãŒ500å††ã‚ªãƒ•ã«ãªã‚‹ã‚“ã§ã™ã‚ˆã€</p>
            <p class="text-sm text-gray-800 font-bold mt-2">ã€Œã•ã‚‰ã«ä»Šæ—¥å…¥ä¼šã„ãŸã ãã¨ä»Šã®ãŠä¼šè¨ˆã‹ã‚‰2000å††ã‚ªãƒ•ã«ãªã‚Šã¾ã™ã‚ˆã€</p>
          </div>

          <div class="p-4 bg-slate-50 rounded-2xl">
            <p class="text-[11px] font-bold text-slate-700 mb-2">ğŸ§¾ ã‚¨ãƒã‚¹ã‚«ãƒ¼ãƒ‰èª¬æ˜</p>
            <p class="text-sm text-gray-800 font-bold">ã€Œå…¥ä¼šè²»ãƒ»å¹´ä¼šè²»ãšã£ã¨ç„¡æ–™ã§ã™ã€</p>
            <p class="text-sm text-gray-800 font-bold mt-2">ã€Œã‚ˆã‹ã£ãŸã‚‰ä»Šæ—¥ãŠä½œã‚Šã—ã¾ã›ã‚“ã‹ï¼Ÿã€</p>
          </div>
        </div>
      </div>

      <!-- Mini tips -->
      <div class="accent-purple p-5 rounded-3xl card-shadow pop">
        <div class="flex items-center gap-2 font-bold text-gray-800 text-sm">
          <i class="fa-solid fa-star text-purple-600"></i>
          <span>ãƒã‚¤ãƒ³ãƒˆ</span>
        </div>
        <ul class="mt-3 space-y-2 text-sm text-gray-700">
          <li class="flex gap-2"><span class="text-purple-600 font-extrabold">ãƒ»</span>ãƒ•ãƒƒã‚¯â†’å¼•ãè¾¼ã¿â†’ã‚«ãƒ¼ãƒ‰èª¬æ˜ã®é †ç•ªé€šã‚Šã«ã‚„ã£ã¦ã¿ã‚‹</li>
          <li class="flex gap-2"><span class="text-purple-600 font-extrabold">ãƒ»</span>ãƒã‚¤ãƒ³ãƒˆã«ãªã‚‹å˜èªã‚’è¦šãˆã¦è¨€ã„ã‚„ã™ã„è¨€ã„æ–¹ã«å¤‰ãˆã¦ã¿ã‚‹</li>
          <li class="flex gap-2"><span class="text-purple-600 font-extrabold">ãƒ»</span>åŸºæœ¬èª¬æ˜ã¯æœ€å¾Œï¼ˆå®‰å¿ƒã§èƒŒä¸­ã‚’æŠ¼ã™ï¼‰</li>
        </ul>
      </div>

      <div class="pb-10"></div>
    </div>

  </div>

  <!-- âœ… è¿½åŠ ï¼šæˆ»ã‚‹ãƒœã‚¿ãƒ³ï¼ˆã“ã®ãƒšãƒ¼ã‚¸ã‚’é–‰ã˜ã¦å…ƒã®ãƒšãƒ¼ã‚¸ã¸ï¼‰ -->
  <button type="button" class="back-btn" onclick="window.close()" aria-label="å…ƒã®ãƒšãƒ¼ã‚¸ã«æˆ»ã‚‹">
    <i class="fa-solid fa-arrow-left text-gray-600"></i>
    æˆ»ã‚‹
  </button>

</body>
</html>`;

function openHookHelpTab() {
  // âœ… data:URL ã¯é•·ã™ãã‚‹ã¨ iPhone/Safari ã§çœŸã£ç™½ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã®ã§ Blob URL ã‚’ä½¿ã†
  const blob = new Blob([HOOK_HELP_HTML], { type: 'text/html;charset=utf-8' });
  const url = URL.createObjectURL(blob);
  const w = window.open(url, '_blank');
  // é–‹ã‘ãŸã‚‰å°‘ã—å¾…ã£ã¦è§£æ”¾ï¼ˆé–‹ã‘ãªã‹ã£ãŸå ´åˆã‚‚ãƒªãƒ¼ã‚¯é˜²æ­¢ï¼‰
  setTimeout(() => URL.revokeObjectURL(url), 30_000);
}

window.addEventListener('load', () => {
  const a = document.getElementById('hook-help-link');
  if (!a) return;
  a.addEventListener('click', (e) => {
    e.preventDefault();
    openHookHelpTab();
  });
});


    (async function init() {
      try {
        await ensureAnonSession();
        await loadHelpfulCountsFromDB();
      } catch (e) {
        console.error(e);
        // UIã¯å¤‰ãˆãªã„æ¡ä»¶ãªã®ã§ã€ç”»é¢è¡¨ç¤ºã¯å¤‰ãˆãšã«consoleã ã‘
      } finally {
        renderRanking();
      }
    })();
  </script>
</body>
</html>
